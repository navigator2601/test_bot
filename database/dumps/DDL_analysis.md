# DDL structure review

## Key integrity findings
- `core.countries` keeps unique constraints on `country_name_ukr`, `iso_code_2` and `iso_code_3`, but all three columns are nullable, тож у схемі дозволені дублікати `NULL`. Рекомендую додати `NOT NULL` (або часткові унікальні індекси) для справжньої унікальності значень довідника країн. 
- У більшості зв'язних таблиць (`product_data.assembly_components`, `filters_system`, `system_features`, `system_modes`, `system_power_supply`) використано як штучний ключ `serial` разом із додатковим унікальним обмеженням на природну пару стовпців. Доцільно зробити складений первинний ключ на бізнес-полі (`system_id`, `unit_code_id` тощо), щоб уникнути дублювання індексів та спростити посилання. 
- `product_data.product_systems` містить понад 30 зовнішніх ключів, але в DDL відсутні відповідні індекси на стовпцях посилань. Для продуктивності CRUD-операцій варто створити нефіктивні B-tree-індекси для кожного стовпця, що часто використовується у `JOIN`/`WHERE`. 
- Вся схема покладається на застарілий синтаксис `serial4`. Перехід на `GENERATED BY DEFAULT AS IDENTITY` спростить керування послідовностями та відповідає сучасним рекомендаціям PostgreSQL.

## Додаткові спостереження
- Розгляньте валідаційні обмеження для полів контактної інформації (`email`, `phone`) та кодів (`edrpou`, `vat_number`) у `core.legal_entities`, якщо дані критично важливі. 
- Для довідників з невеликим набором значень (`product_meta.efficiency_class_lookup`, `operation_modes`) можна додати індекси `LOWER(name)` або окремі таблиці локалізацій, якщо потрібні пошуки без урахування регістру чи багатомовність.
